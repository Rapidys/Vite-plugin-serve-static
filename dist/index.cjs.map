{"version":3,"sources":["../src/index.ts","../src/fileHandler.ts","../src/mimeTypes.ts"],"sourcesContent":["import { Plugin, ViteDevServer } from 'vite';\nimport { handleFileRequest } from './fileHandler';\nimport { ServeStaticOptions } from './types';\n\nexport function serveStatic(options: ServeStaticOptions = {}): Plugin {\n\n    const config = options;\n\n    return {\n        name: 'vite-serve-static',\n        configureServer(server: ViteDevServer) {\n            server.middlewares.use((req, res, next) => {\n                handleFileRequest(req, res, next, config.routes!);\n            });\n        }\n    };\n}\n","import path from 'path';\nimport fs from 'fs';\nimport { mimeTypes } from './mimeTypes';\nimport { RouteConfig } from './types';\n\nexport function handleFileRequest(req: any, res: any, next: any, routes: RouteConfig[]) {\n    if (!req.url) {\n        return next();\n    }\n\n    for (const route of routes) {\n        if (req.url.startsWith(route.route)) {\n            let filePath: string | undefined;\n\n            try {\n                // Handle the directory or file path\n                if (route.dir) {\n                    const relativePath = decodeURIComponent(req.url.replace(route.route, ''));\n                    filePath = path.resolve(path.join(route.dir, relativePath));\n                } else if (route.file) {\n                    filePath = path.resolve(route.file);\n                }\n\n                // Path Traversal Protection\n                if (filePath && !filePath.startsWith(path.resolve(route.dir || ''))) {\n                    console.error(`Illegal path access attempt: ${filePath}`);\n                    res.statusCode = 403; // Forbidden\n                    res.end('Forbidden');\n                    return;\n                }\n\n                // Check file existence\n                if (filePath && fs.existsSync(filePath)) {\n                    const ext = path.extname(filePath);\n                    const mimeType = mimeTypes[ext] || 'application/octet-stream';\n                    res.setHeader('Content-Type', mimeType);\n\n                    const stream = fs.createReadStream(filePath);\n                    stream.on('error', (err) => {\n                        console.error(`Stream error: ${err.message}`);\n                        res.statusCode = 500; // Internal Server Error\n                        res.end('Internal Server Error');\n                    });\n                    stream.pipe(res);\n                    return;\n                } else {\n                    console.error(`File not found: ${filePath}`);\n                    res.statusCode = 404;\n                    res.end('File not found');\n                    return;\n                }\n            } catch (error) {\n                console.error(`Error processing request for ${req.url}: ${error.message}`);\n                res.statusCode = 500;\n                res.end('Internal Server Error');\n                return;\n            }\n        }\n    }\n\n    next();\n}\n","export const mimeTypes: Record<string, string> = {\n    '.css': 'text/css',\n    '.ttf': 'font/ttf',\n    '.woff': 'font/woff',\n    '.woff2': 'font/woff2',\n    '.eot': 'application/vnd.ms-fontobject',\n    '.otf': 'font/otf',\n    '.svg': 'image/svg+xml',\n    '.js': 'application/javascript',\n    '.3g2': 'video/3gpp2',\n    '.3gp': 'video/3gpp',\n    '.3gpp': 'video/3gpp',\n    '.3mf': 'model/3mf',\n    '.aac': 'audio/aac',\n    '.ac': 'application/pkix-attr-cert',\n    '.adp': 'audio/adpcm',\n    '.adts': 'audio/aac',\n    '.ai': 'application/postscript',\n    '.aml': 'application/automationml-aml+xml',\n    '.amlx': 'application/automationml-amlx+zip',\n    '.amr': 'audio/amr',\n    '.apng': 'image/apng',\n    '.appcache': 'text/cache-manifest',\n    '.appinstaller': 'application/appinstaller',\n    '.appx': 'application/appx',\n    '.appxbundle': 'application/appxbundle',\n    '.asc': 'application/pgp-keys',\n    '.atom': 'application/atom+xml',\n    '.atomcat': 'application/atomcat+xml',\n    '.atomdeleted': 'application/atomdeleted+xml',\n    '.atomsvc': 'application/atomsvc+xml',\n    '.au': 'audio/basic',\n    '.avci': 'image/avci',\n    '.avcs': 'image/avcs',\n    '.avif': 'image/avif',\n    '.aw': 'application/applixware',\n    '.bdoc': 'application/bdoc',\n    '.bin': 'application/octet-stream',\n    '.bmp': 'image/bmp',\n    '.bpk': 'application/octet-stream',\n    '.btf': 'image/prs.btif',\n    '.btif': 'image/prs.btif',\n    '.buffer': 'application/octet-stream',\n    '.ccxml': 'application/ccxml+xml',\n    '.cdfx': 'application/cdfx+xml',\n    '.cdmia': 'application/cdmi-capability',\n    '.cdmic': 'application/cdmi-container',\n    '.cdmid': 'application/cdmi-domain',\n    '.cdmio': 'application/cdmi-object',\n    '.cdmiq': 'application/cdmi-queue',\n    '.cer': 'application/pkix-cert',\n    '.cgm': 'image/cgm',\n    '.cjs': 'application/node',\n    '.class': 'application/java-vm',\n    '.coffee': 'text/coffeescript',\n    '.conf': 'text/plain',\n    '.cpl': 'application/cpl+xml',\n    '.cpt': 'application/mac-compactpro',\n    '.crl': 'application/pkix-crl',\n    '.csv': 'text/csv',\n    '.cu': 'application/cu-seeme',\n    '.cwl': 'application/cwl',\n    '.cww': 'application/prs.cww',\n    '.davmount': 'application/davmount+xml',\n    '.dbk': 'application/docbook+xml',\n    '.deb': 'application/octet-stream',\n    '.def': 'text/plain',\n    '.deploy': 'application/octet-stream',\n    '.dib': 'image/bmp',\n    '.disposition-notification': 'message/disposition-notification',\n    '.dist': 'application/octet-stream',\n    '.distz': 'application/octet-stream',\n    '.dll': 'application/octet-stream',\n    '.dmg': 'application/octet-stream',\n    '.dms': 'application/octet-stream',\n    '.doc': 'application/msword',\n    '.dot': 'application/msword',\n    '.dpx': 'image/dpx',\n    '.drle': 'image/dicom-rle',\n    '.dsc': 'text/prs.lines.tag',\n    '.dssc': 'application/dssc+der',\n    '.dtd': 'application/xml-dtd',\n    '.dump': 'application/octet-stream',\n    '.dwd': 'application/atsc-dwd+xml',\n    '.ear': 'application/java-archive',\n    '.ecma': 'application/ecmascript',\n    '.elc': 'application/octet-stream',\n    '.emf': 'image/emf',\n    '.eml': 'message/rfc822',\n    '.emma': 'application/emma+xml',\n    '.emotionml': 'application/emotionml+xml',\n    '.eps': 'application/postscript',\n    '.epub': 'application/epub+zip',\n    '.exe': 'application/octet-stream',\n    '.exif': 'image/exif',\n    '.flac': 'audio/flac',\n    '.flv': 'video/x-flv',\n    '.gif': 'image/gif',\n    '.gz': 'application/gzip',\n    '.h261': 'video/h261',\n    '.h263': 'video/h263',\n    '.h264': 'video/h264',\n    '.hdtv': 'video/hdtv',\n    '.heif': 'image/heif',\n    '.heic': 'image/heic',\n    '.htc': 'text/x-component',\n    '.htm': 'text/html',\n    '.html': 'text/html',\n    '.ico': 'image/vnd.microsoft.icon',\n    '.ics': 'text/calendar',\n    '.ifb': 'text/calendar',\n    '.ini': 'text/plain',\n    '.ipynb': 'application/x-ipynb+json',\n    '.jar': 'application/java-archive',\n    '.jpeg': 'image/jpeg',\n    '.jpg': 'image/jpeg',\n    '.json': 'application/json',\n    '.jsonld': 'application/ld+json',\n    '.jsonp': 'application/javascript',\n    '.m3u8': 'application/vnd.apple.mpegurl',\n    '.m4a': 'audio/mp4a-latm',\n    '.m4b': 'audio/mp4a-latm',\n    '.m4p': 'audio/mp4a-latm',\n    '.m4v': 'video/x-m4v',\n    '.m5p': 'application/m5p',\n    '.m3u': 'audio/mpeg-url',\n    '.m3g': 'video/mpeg',\n    '.mp2': 'audio/mpeg',\n    '.mp3': 'audio/mpeg',\n    '.mp4': 'video/mp4',\n    '.mp4a': 'audio/mp4',\n    '.mp4v': 'video/mp4',\n    '.mpa': 'audio/mpeg',\n    '.mpeg': 'video/mpeg',\n    '.mpg': 'video/mpeg',\n    '.msg': 'application/vnd.ms-outlook',\n    '.mxf': 'application/mxf',\n    '.nupkg': 'application/x-nupkg',\n    '.nws': 'message/rfc822',\n    '.odg': 'application/vnd.oasis.opendocument.graphics',\n    '.odp': 'application/vnd.oasis.opendocument.presentation',\n    '.ods': 'application/vnd.oasis.opendocument.spreadsheet',\n    '.odt': 'application/vnd.oasis.opendocument.text',\n    '.oga': 'audio/ogg',\n    '.ogg': 'audio/ogg',\n    '.ogv': 'video/ogg',\n    '.ogx': 'application/ogg',\n    '.pdf': 'application/pdf',\n    '.php': 'application/x-httpd-php',\n    '.png': 'image/png',\n    '.ppt': 'application/vnd.ms-powerpoint',\n    '.pptx': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n    '.ra': 'audio/vnd.rn-realaudio',\n    '.ram': 'audio/x-realaudio',\n    '.rar': 'application/x-rar-compressed',\n    '.raw': 'image/raw',\n    '.rexx': 'application/rexx',\n    '.rtf': 'application/rtf',\n    '.s3m': 'audio/s3m',\n    '.sgml': 'text/sgml',\n    '.sh': 'application/x-sh',\n    '.sig': 'application/pgp-signature',\n    '.smi': 'application/smil+xml',\n    '.smil': 'application/smil+xml',\n    '.so': 'application/octet-stream',\n    '.swf': 'application/x-shockwave-flash',\n    '.tar': 'application/x-tar',\n    '.tif': 'image/tiff',\n    '.tiff': 'image/tiff',\n    '.ts': 'video/mp2t',\n    '.txt': 'text/plain',\n    '.webm': 'video/webm',\n    '.webp': 'image/webp',\n    '.wma': 'audio/x-ms-wma',\n    '.wmv': 'video/x-ms-wmv',\n    '.xml': 'application/xml',\n    '.xul': 'application/vnd.mozilla.xul+xml',\n    '.zip': 'application/zip',\n};\n"],"mappings":"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","names":["src_exports","__export","serveStatic","__toCommonJS","import_path","import_fs","mimeTypes","handleFileRequest","req","res","next","routes","route","filePath","relativePath","path","fs","ext","mimeType","mimeTypes","stream","err","error","serveStatic","options","config","server","req","res","next","handleFileRequest"]}